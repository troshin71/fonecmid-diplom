Процедура ОбработкаПроведения(Отказ, Режим)
	
	// Инициализация
	Движения.ВКМ_ДополнительныеНачисления.Записывать = Истина;
	Движения.ВКМ_Удержания.Записывать = Истина;
	Движения.ВКМ_ВзаиморасчетыССотрудниками.Записывать = Истина;
	
	Для Каждого Строка Из СписокСотрудников Цикл
		
		// 1. Начисляем премию
		ДвижениеНач = Движения.ВКМ_ДополнительныеНачисления.Добавить();
		ДвижениеНач.ПериодРегистрации = Дата;
		ДвижениеНач.ВКМ_Сотрудник = Строка.Сотрудник;
		// Используем ваш вид расчета (или создайте "ФиксированнаяПремия")
		ДвижениеНач.ВидРасчета = ПланыВидовРасчета.ВКМ_ДополнительныеНачисления.Премия; 
		ДвижениеНач.ВКМ_Результат = Строка.СуммаПремии;
		
		// 2. Считаем НДФЛ
		СуммаНДФЛ = Строка.СуммаПремии * 0.13;
		
		ДвижениеУдерж = Движения.ВКМ_Удержания.Добавить();
		ДвижениеУдерж.ПериодРегистрации = Дата;
		ДвижениеУдерж.ВКМ_Сотрудник = Строка.Сотрудник;
		ДвижениеУдерж.ВидРасчета = ПланыВидовРасчета.ВКМ_Удержания.НДФЛ;
		ДвижениеУдерж.ВКМ_Результат = СуммаНДФЛ;
		
		// 3. Записываем долг перед сотрудником (Сумма - НДФЛ)
		ДвижениеВзаиморасчет = Движения.ВКМ_ВзаиморасчетыССотрудниками.Добавить();
		ДвижениеВзаиморасчет.ВидДвижения = ВидДвиженияНакопления.Приход;
		ДвижениеВзаиморасчет.Период = Дата;
		ДвижениеВзаиморасчет.ВКМ_Сотрудник = Строка.Сотрудник;
		ДвижениеВзаиморасчет.ВКМ_Сумма = Строка.СуммаПремии - СуммаНДФЛ;
		
	КонецЦикла;
	
КонецПроцедуры